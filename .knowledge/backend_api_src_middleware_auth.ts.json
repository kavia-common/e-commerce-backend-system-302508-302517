{"is_source_file": true, "format": "TypeScript", "description": "This file implements middleware functions for authentication and role authorization in an Express.js server. It includes JWT token verification, environment variable handling for the secret, and role-based access control.", "external_files": ["../errors/httpErrors"], "external_methods": ["jwt.verify"], "published": ["requireAuth", "requireRole"], "classes": [], "methods": [{"name": "requireAuth", "description": "Middleware function that verifies the presence and validity of a JWT in the Authorization header and attaches the decoded user info to the request object."}, {"name": "export function requireRole(...allowedRoles: Role[]): RequestHandler { requireRole", "description": "Middleware factory that checks if the authenticated user has one of the specified roles, enforcing role-based access control.", "scope": "", "scopeKind": ""}, {"name": "function getJwtSecret(): string { getJwtSecret", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["jwt.verify", "process.env.JWT_SECRET", "req.header", "next"], "search-terms": ["auth middleware", "JWT verification", "role-based access", "express RequestHandler", "JwtPayload"], "state": 2, "file_id": 18, "knowledge_revision": 60, "git_revision": "acdf6c5f71c0ea8b20a8614e60589a49d7717633", "ctags": [{"_type": "tag", "name": "Express", "path": "/home/kavia/workspace/code-generation/e-commerce-backend-system-302508-302517/backend_api/src/middleware/auth.ts", "pattern": "/^  namespace Express {$/", "language": "TypeScript", "kind": "namespace"}, {"_type": "tag", "name": "JwtPayload", "path": "/home/kavia/workspace/code-generation/e-commerce-backend-system-302508-302517/backend_api/src/middleware/auth.ts", "pattern": "/^export type JwtPayload = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "Request", "path": "/home/kavia/workspace/code-generation/e-commerce-backend-system-302508-302517/backend_api/src/middleware/auth.ts", "pattern": "/^    interface Request {$/", "language": "TypeScript", "kind": "interface", "scope": "Express", "scopeKind": "namespace"}, {"_type": "tag", "name": "decoded", "path": "/home/kavia/workspace/code-generation/e-commerce-backend-system-302508-302517/backend_api/src/middleware/auth.ts", "pattern": "/^    const decoded = jwt.verify(token, getJwtSecret()) as JwtPayload;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "getJwtSecret", "path": "/home/kavia/workspace/code-generation/e-commerce-backend-system-302508-302517/backend_api/src/middleware/auth.ts", "pattern": "/^function getJwtSecret(): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "requireAuth", "path": "/home/kavia/workspace/code-generation/e-commerce-backend-system-302508-302517/backend_api/src/middleware/auth.ts", "pattern": "/^export const requireAuth: RequestHandler = (req, _res, next) => {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "requireRole", "path": "/home/kavia/workspace/code-generation/e-commerce-backend-system-302508-302517/backend_api/src/middleware/auth.ts", "pattern": "/^export function requireRole(...allowedRoles: Role[]): RequestHandler {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "secret", "path": "/home/kavia/workspace/code-generation/e-commerce-backend-system-302508-302517/backend_api/src/middleware/auth.ts", "pattern": "/^  const secret = process.env.JWT_SECRET;$/", "language": "TypeScript", "kind": "constant", "scope": "getJwtSecret", "scopeKind": "function"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/e-commerce-backend-system-302508-302517/backend_api/src/middleware/auth.ts", "pattern": "/^      user?: JwtPayload;$/", "language": "TypeScript", "kind": "property", "scope": "Express.Request", "scopeKind": "interface"}], "hash": "17045d4e03040dec7c507aa733f976a2", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/middleware/auth.ts", "fields": [{"name": "interface Request {", "scope": "Express", "scopeKind": "namespace", "description": "unavailable"}, {"name": "user?: JwtPayload;", "scope": "Express.Request", "scopeKind": "interface", "description": "unavailable"}], "revision_history": [{"60": "acdf6c5f71c0ea8b20a8614e60589a49d7717633"}]}